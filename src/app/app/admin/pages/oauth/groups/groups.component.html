<app-admin-page>

    <div class="rk_accounts__card">
        <div class="card__header flex flex-row justify-content-between align-items-center">
            <div>
                <h2 class="my-0">Groups</h2>
                <div class="subtitle mt-2">List of all OAuth2 groups</div>
            </div>
            <button pButton class="p-button-sm bg-white text-black-alpha-90 font-bold uppercase" label="Create" disabled></button>
        </div>
        <div class="card__content">
            <p-table styleClass="card-table" [value]="groups" dataKey="name" responsiveLayout="scroll">
                <ng-template pTemplate="header">
                    <tr>
                        <th style="width: 3rem"></th>
                        <th pSortableColumn="name">Name
                            <p-sortIcon field="name"></p-sortIcon>
                        </th>
                        <th pSortableColumn="name">Display name
                            <p-sortIcon field="display_name"></p-sortIcon>
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-group let-expanded="expanded">
                    <tr>
                        <td>
                            <button type="button" pButton pRipple [pRowToggler]="group" class="p-button-text p-button-rounded p-button-plain" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
                        </td>
                        <td>{{group.name}}</td>
                        <td>{{group.display_name}}</td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="rowexpansion" let-group>
                    <tr>
                        <td colspan="7">
                            <div class="p-p-3">
                                <p-table [value]="group.accounts" dataKey="uuid" responsiveLayout="scroll">
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th style="width: 4rem">
                                                Avatar
                                            </th>
                                            <th pSortableColumn="username">Username
                                                <p-sortIcon field="username"></p-sortIcon>
                                            </th>
                                            <th style="width: 4rem">
                                                <button pButton class="p-button-sm" icon="pi pi-user-plus" label="Add"></button>
                                            </th>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="body" let-account>
                                        <tr>
                                            <td>
                                                <p-avatar styleClass="p-mr-2" size="large" [image]="account.avatar"></p-avatar>
                                            </td>
                                            <td>{{account.username}}</td>
                                            <td>
                                                <button pButton class="p-button-sm p-button-danger" icon="pi pi-user-minus" label="Kick"></button>
                                            </td>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="emptymessage">
                                        <tr>
                                            <td colspan="6">There are no accounts for this group yet.</td>
                                        </tr>
                                    </ng-template>
                                </p-table>
                            </div>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</app-admin-page>